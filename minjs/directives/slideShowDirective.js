app.directive("slideShowDirective",["snowballService",function(a){return{restrict:"ACE",scope:{onPlayClick:"&onPlayClick",detail:"=detail"},link:function(b,c,d){function e(a,b,c,d){this.slideShow=a,this.items=b,this.detail=c,this.collapse=!1,d?this.options=d:this.options={padding:20,width:300,height:300,playImageWidth:50,playImageHeight:50}}var f=$(c);e.prototype.init=function(){$(this.slideShow).css({width:this.options.width,height:this.options.height});for(var b=this.detail.snowball.items,c=0;c<b.length;c++){var d=$("<div></div>");d.css("position","relative"),d.css("width",this.options.width),d.css("height",this.options.height);var e=b[c],f=a.getThumbnail(e.collaboration.url),g=$("<img>");g.attr("width",this.options.width-2*this.options.padding),g.attr("height",this.options.width-2*this.options.padding),g.css("position","absolute"),g.css("top",this.options.padding),g.css("left",this.options.padding),g.css("border-radius","3px"),g.css("box-shadow","0px 10px 10px rgb(2,31,52)"),g.attr("src",f),d.append(g);var h=$("<img>");h.attr("width",this.options.playImageWidth),h.attr("height",this.options.playImageHeight),h.attr("src","../images/slideshow/play.png"),h.css({position:"absolute",left:this.options.width/2-this.options.playImageWidth/2,top:this.options.height/2-this.options.playImageHeight/2,"z-index":"1000"});var i=this;!function(a){h.on("mousedown",function(b){i.playCallback&&i.playCallback({$item:a,$detail:i.detail}),b.preventDefault()})}(e),d.append(h),$(this.slideShow).append(d)}$(this.slideShow).slick({infinite:!1,slidesToShow:1,slidesToScroll:1,useCSS:!0});var i=this;$(this.slideShow).on("click",function(){i.collapse?(i.slideShow.css("transition","-webkit-transform 400ms ease"),i.slideShow.css("transform","scale(1)")):(i.slideShow.css("transition","-webkit-transform 400ms ease"),i.slideShow.css("transform","scale(0.8)")),i.collapse=!i.collapse})},e.prototype.setPlayCallback=function(a){this.playCallback=a},b.$watch("detail",function(a,c){if(a){var d=new e(f,a.snowball.items,a);d.init(),d.setPlayCallback(function(a){b.$apply(function(){b.onPlayClick(a)})})}})}}}]);